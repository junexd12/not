-- GabGui v2.0 - Rayfield Inspired (COMPLETE WORKING VERSION)
-- Modern purple theme with full functionality

local Players = game:GetService("Players")
local TweenService = game:GetService("TweenService")
local UserInputService = game:GetService("UserInputService")
local RunService = game:GetService("RunService")
local HttpService = game:GetService("HttpService")
local CoreGui = game:GetService("CoreGui")

local player = Players.LocalPlayer
local PlayerGui = player:WaitForChild("PlayerGui")

-- Modern Rayfield Theme
local THEME = {
    Background = Color3.fromRGB(25, 25, 30),
    Header = Color3.fromRGB(35, 35, 40),
    Accent = Color3.fromRGB(180, 0, 255),
    Button = Color3.fromRGB(40, 40, 50),
    Element = Color3.fromRGB(45, 45, 55),
    Secondary = Color3.fromRGB(30, 30, 35),
    Input = Color3.fromRGB(50, 50, 60),
    
    Hover = Color3.fromRGB(55, 0, 110),
    Active = Color3.fromRGB(70, 0, 130),
    Error = Color3.fromRGB(85, 0, 0),
    
    ToggleOn = Color3.fromRGB(180, 0, 255),
    ToggleOff = Color3.fromRGB(70, 70, 80),
    
    SliderTrack = Color3.fromRGB(50, 0, 90),
    SliderFill = Color3.fromRGB(170, 0, 255),
    
    Text = Color3.fromRGB(235, 235, 235),
    TextSecondary = Color3.fromRGB(180, 180, 185),
    Placeholder = Color3.fromRGB(160, 100, 220),
    
    Stroke = Color3.fromRGB(170, 0, 255),
    StrokeSecondary = Color3.fromRGB(140, 0, 255),
    
    Corner = UDim.new(0, 8),
    WindowSize = UDim2.new(0, 520, 0, 420)
}

-- Utility Functions
local function create(class, properties)
    local object = Instance.new(class)
    for property, value in pairs(properties or {}) do
        if property ~= "Parent" then
            pcall(function() object[property] = value end)
        end
    end
    if properties and properties.Parent then
        object.Parent = properties.Parent
    end
    return object
end

local function tween(object, duration, properties, easingStyle, easingDirection)
    easingStyle = easingStyle or Enum.EasingStyle.Quart
    easingDirection = easingDirection or Enum.EasingDirection.Out
    TweenService:Create(object, TweenInfo.new(duration or 0.3, easingStyle, easingDirection), properties):Play()
end

-- Draggable System
local function makeDraggable(window, dragBar)
    local dragging = false
    local dragStart = nil
    local startPos = nil
    
    local function updatePosition(input)
        if dragging then
            local delta = input.Position - dragStart
            window.Position = UDim2.new(
                startPos.X.Scale, 
                startPos.X.Offset + delta.X, 
                startPos.Y.Scale, 
                startPos.Y.Offset + delta.Y
            )
        end
    end
    
    dragBar.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            dragging = true
            dragStart = input.Position
            startPos = window.Position
            
            input.Changed:Connect(function()
                if input.UserInputState == Enum.UserInputState.End then
                    dragging = false
                end
            end)
        end
    end)
    
    UserInputService.InputChanged:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseMovement then
            updatePosition(input)
        end
    end)
end

-- Notification System
local Notifications = {}
function GabGuiLibrary:Notify(data)
    data = data or {}
    local title = data.Title or "Notification"
    local content = data.Content or "No content provided"
    local duration = data.Duration or 3
    local image = data.Image or 4483362458
    
    local notificationGui = create("ScreenGui", {
        Parent = CoreGui,
        ResetOnSpawn = false,
        Name = "GabGuiNotification"
    })
    
    local notificationFrame = create("Frame", {
        Parent = notificationGui,
        Size = UDim2.new(0, 320, 0, 72),
        Position = UDim2.new(1, -340, 0, 24 + (#Notifications * 84)),
        BackgroundColor3 = THEME.Header,
        BorderSizePixel = 0
    })
    
    create("UICorner", {Parent = notificationFrame, CornerRadius = THEME.Corner})
    create("UIStroke", {Parent = notificationFrame, Color = THEME.Accent, Thickness = 1.5})
    
    -- Icon
    if image and image ~= 0 then
        local icon = create("ImageLabel", {
            Parent = notificationFrame,
            Size = UDim2.new(0, 40, 0, 40),
            Position = UDim2.new(0, 12, 0.5, -20),
            BackgroundTransparency = 1,
            Image = "rbxassetid://" .. tostring(image),
            ImageColor3 = THEME.Accent
        })
        create("UICorner", {Parent = icon, CornerRadius = UDim.new(0, 6)})
    end
    
    -- Title
    create("TextLabel", {
        Parent = notificationFrame,
        Position = UDim2.new(0, image ~= 0 and 60 or 12, 0, 8),
        Size = UDim2.new(1, -24, 0, 20),
        BackgroundTransparency = 1,
        Text = title,
        Font = Enum.Font.GothamBold,
        TextSize = 16,
        TextColor3 = THEME.Text,
        TextXAlignment = Enum.TextXAlignment.Left
    })
    
    -- Content
    create("TextLabel", {
        Parent = notificationFrame,
        Position = UDim2.new(0, image ~= 0 and 60 or 12, 0, 28),
        Size = UDim2.new(1, -24, 0, 36),
        BackgroundTransparency = 1,
        Text = content,
        Font = Enum.Font.Gotham,
        TextSize = 14,
        TextColor3 = THEME.Text,
        TextWrapped = true,
        TextXAlignment = Enum.TextXAlignment.Left
    })
    
    -- Slide in
    table.insert(Notifications, notificationFrame)
    tween(notificationFrame, 0.4, {Position = UDim2.new(1, -340, 0, 24 + (#Notifications - 1) * 84)})
    
    -- Auto remove
    task.delay(duration, function()
        local index = table.find(Notifications, notificationFrame)
        if index then
            table.remove(Notifications, index)
        end
        
        -- Update positions of remaining notifications
        for i, notif in ipairs(Notifications) do
            tween(notif, 0.3, {Position = UDim2.new(1, -340, 0, 24 + (i - 1) * 84)})
        end
        
        tween(notificationFrame, 0.3, {Position = UDim2.new(1, -20, 0, notificationFrame.Position.Y.Offset)})
        task.wait(0.3)
        notificationGui:Destroy()
    end)
end

-- Main Library
local GabGuiLibrary = {}
GabGuiLibrary.Theme = THEME
GabGuiLibrary.Flags = {}

-- Settings System
local settings = {
    General = {
        GabGuiOpen = {Type = 'bind', Value = 'K', Name = 'GabGui Keybind'},
    },
    System = {
        usageAnalytics = {Type = 'toggle', Value = true, Name = 'Anonymised Analytics'},
    }
}

local overriddenSettings = {}
function GabGuiLibrary:getSetting(category, name)
    local key = category .. "." .. name
    return overriddenSettings[key] or (settings[category] and settings[category][name] and settings[category][name].Value) or nil
end

function GabGuiLibrary:overrideSetting(category, name, value)
    overriddenSettings[category .. "." .. name] = value
end

-- Window Creation
function GabGuiLibrary:CreateWindow(config)
    config = config or {}
    local windowName = config.Name or "GabGui Window"
    local size = config.Size or THEME.WindowSize
    local position = config.Position or UDim2.new(0.5, -size.X.Offset/2, 0.5, -size.Y.Offset/2)
    local loadingTitle = config.LoadingTitle or "GabGui Interface"
    local loadingSubtitle = config.LoadingSubtitle or "Loading..."
    local icon = config.Icon or 0
    local configSaving = config.ConfigurationSaving or {Enabled = false, FileName = tostring(game.PlaceId)}
    
    -- Create GUI
    local ScreenGui = create("ScreenGui", {
        Parent = CoreGui,
        ResetOnSpawn = false,
        IgnoreGuiInset = true,
        Name = "GabGui_" .. windowName
    })
    
    -- Main Window
    local Window = create("Frame", {
        Parent = ScreenGui,
        Size = UDim2.new(0, 0, 0, 0),
        Position = UDim2.new(0.5, 0, 0.5, 0),
        BackgroundColor3 = THEME.Background,
        BorderSizePixel = 0,
        Active = true,
        Visible = true
    })
    create("UICorner", {Parent = Window, CornerRadius = THEME.Corner})
    create("UIStroke", {Parent = Window, Color = THEME.Accent, Thickness = 2})
    
    -- Header
    local Header = create("Frame", {
        Parent = Window,
        Size = UDim2.new(1, 0, 0, 45),
        BackgroundColor3 = THEME.Header,
        BorderSizePixel = 0
    })
    create("UICorner", {Parent = Header, CornerRadius = THEME.Corner})
    
    -- Title Bar
    local TitleBar = create("Frame", {
        Parent = Header,
        Size = UDim2.new(1, -60, 1, 0),
        Position = UDim2.new(0, 12, 0, 0),
        BackgroundTransparency = 1
    })
    
    -- Window Icon
    if icon and icon ~= 0 then
        local windowIcon = create("ImageLabel", {
            Parent = TitleBar,
            Size = UDim2.new(0, 24, 0, 24),
            Position = UDim2.new(0, 0, 0.5, -12),
            BackgroundTransparency = 1,
            Image = "rbxassetid://" .. tostring(icon),
            ImageColor3 = THEME.Accent
        })
        create("UICorner", {Parent = windowIcon, CornerRadius = UDim.new(0, 4)})
    end
    
    -- Window Title
    local TitleLabel = create("TextLabel", {
        Parent = TitleBar,
        Position = UDim2.new(0, icon ~= 0 and 32 or 0, 0.5, -9),
        Size = UDim2.new(1, 0, 1, 0),
        BackgroundTransparency = 1,
        Text = windowName,
        Font = Enum.Font.GothamBold,
        TextSize = 16,
        TextColor3 = THEME.Text,
        TextXAlignment = Enum.TextXAlignment.Left,
        TextYAlignment = Enum.TextYAlignment.Center
    })
    
    -- Window Controls
    local MinimizeButton = create("TextButton", {
        Parent = Header,
        Size = UDim2.new(0, 30, 0, 30),
        Position = UDim2.new(1, -70, 0.5, -15),
        BackgroundColor3 = THEME.Secondary,
        Text = "−",
        Font = Enum.Font.GothamBold,
        TextSize = 18,
        TextColor3 = THEME.Text,
        BorderSizePixel = 0,
        AutoButtonColor = false
    })
    create("UICorner", {Parent = MinimizeButton, CornerRadius = UDim.new(0, 4)})
    
    local CloseButton = create("TextButton", {
        Parent = Header,
        Size = UDim2.new(0, 30, 0, 30),
        Position = UDim2.new(1, -35, 0.5, -15),
        BackgroundColor3 = Color3.fromRGB(255, 85, 85),
        Text = "×",
        Font = Enum.Font.GothamBold,
        TextSize = 18,
        TextColor3 = Color3.fromRGB(255, 255, 255),
        BorderSizePixel = 0,
        AutoButtonColor = false
    })
    create("UICorner", {Parent = CloseButton, CornerRadius = UDim.new(0, 4)})
    
    -- Tab System
    local TabBar = create("ScrollingFrame", {
        Parent = Window,
        Size = UDim2.new(1, -20, 0, 42),
        Position = UDim2.new(0, 10, 0, 50),
        BackgroundColor3 = THEME.Element,
        BorderSizePixel = 0,
        ScrollBarThickness = 4,
        ScrollBarImageColor3 = THEME.Accent,
        CanvasSize = UDim2.new(0, 0, 0, 0),
        AutomaticCanvasSize = Enum.AutomaticSize.X,
        ScrollingDirection = Enum.ScrollingDirection.X
    })
    create("UICorner", {Parent = TabBar, CornerRadius = THEME.Corner})
    create("UIStroke", {Parent = TabBar, Color = THEME.Stroke, Thickness = 1})
    
    local TabLayout = create("UIListLayout", {
        Parent = TabBar,
        FillDirection = Enum.FillDirection.Horizontal,
        Padding = UDim.new(0, 8),
        HorizontalAlignment = Enum.HorizontalAlignment.Left
    })
    
    -- Content Area
    local ContentFrame = create("Frame", {
        Parent = Window,
        Size = UDim2.new(1, -20, 1, -102),
        Position = UDim2.new(0, 10, 0, 97),
        BackgroundTransparency = 1
    })
    
    -- Tab Management
    local Tabs = {}
    local ActiveTabIndex = 1
    
    -- Make window draggable
    makeDraggable(Window, Header)
    
    -- Window Object
    local WindowObject = {
        Name = windowName,
        Flags = {},
        Tabs = Tabs,
        ConfigurationSaving = configSaving
    }
    
    -- Close window
    CloseButton.MouseButton1Click:Connect(function()
        ScreenGui:Destroy()
    end)
    
    -- Minimize window
    local minimized = false
    MinimizeButton.MouseButton1Click:Connect(function()
        minimized = not minimized
        if minimized then
            tween(Window, 0.3, {Size = UDim2.new(0, size.X.Offset, 0, 45)})
            MinimizeButton.Text = "+"
        else
            tween(Window, 0.3, {Size = size})
            MinimizeButton.Text = "−"
        end
    end)
    
    -- Create Tab
    function WindowObject:CreateTab(name, icon)
        local tabIndex = #Tabs + 1
        
        -- Tab Button
        local tabButton = create("TextButton", {
            Parent = TabBar,
            Size = UDim2.new(0, 120, 1, 0),
            BackgroundColor3 = tabIndex == 1 and THEME.Accent or THEME.Button,
            Text = name,
            Font = Enum.Font.GothamSemibold,
            TextSize = 14,
            TextColor3 = THEME.Text,
            BorderSizePixel = 0,
            AutoButtonColor = false
        })
        create("UICorner", {Parent = tabButton, CornerRadius = THEME.Corner})
        local tabStroke = create("UIStroke", {
            Parent = tabButton,
            Color = THEME.Stroke,
            Thickness = 1,
            Transparency = tabIndex == 1 and 0 or 0.5
        })
        
        -- Tab Icon
        if icon and icon ~= 0 then
            local tabIcon = create("ImageLabel", {
                Parent = tabButton,
                Size = UDim2.new(0, 20, 0, 20),
                Position = UDim2.new(0, 8, 0.5, -10),
                BackgroundTransparency = 1,
                Image = "rbxassetid://" .. tostring(icon),
                ImageColor3 = tabIndex == 1 and Color3.fromRGB(255, 255, 255) or THEME.TextSecondary
            })
            create("UICorner", {Parent = tabIcon, CornerRadius = UDim.new(0, 4)})
            tabButton.TextXAlignment = Enum.TextXAlignment.Left
            tabButton.Text = "  " .. name
        end
        
        -- Tab Content
        local tabContent = create("ScrollingFrame", {
            Parent = ContentFrame,
            Size = UDim2.new(1, 0, 1, 0),
            BackgroundTransparency = 1,
            BorderSizePixel = 0,
            ScrollBarThickness = 6,
            ScrollBarImageColor3 = THEME.Accent,
            CanvasSize = UDim2.new(0, 0, 0, 0),
            AutomaticCanvasSize = Enum.AutomaticSize.Y,
            Visible = tabIndex == 1
        })
        local contentLayout = create("UIListLayout", {
            Parent = tabContent,
            Padding = UDim.new(0, 8),
            SortOrder = Enum.SortOrder.LayoutOrder
        })
        
        -- Tab switching
        tabButton.MouseButton1Click:Connect(function()
            for i, tabData in ipairs(Tabs) do
                tabData.content.Visible = false
                tabData.button.BackgroundColor3 = THEME.Button
                tabData.button.UIStroke.Transparency = 0.5
                if tabData.button:FindFirstChild("ImageLabel") then
                    tabData.button.ImageLabel.ImageColor3 = THEME.TextSecondary
                end
            end
            
            tabContent.Visible = true
            tabButton.BackgroundColor3 = THEME.Accent
            tabStroke.Transparency = 0
            if tabButton:FindFirstChild("ImageLabel") then
                tabButton.ImageLabel.ImageColor3 = Color3.fromRGB(255, 255, 255)
            end
            ActiveTabIndex = tabIndex
        end)
        
        -- Store tab data
        local tabData = {
            name = name,
            button = tabButton,
            content = tabContent,
            elements = {}
        }
        table.insert(Tabs, tabData)
        
        -- Tab Object
        local Tab = {}
        
        -- Create Section
        function Tab:CreateSection(sectionName)
            local sectionFrame = create("Frame", {
                Parent = tabContent,
                Size = UDim2.new(1, -20, 0, 30),
                BackgroundTransparency = 1
            })
            
            local sectionLabel = create("TextLabel", {
                Parent = sectionFrame,
                Size = UDim2.new(1, 0, 1, 0),
                BackgroundTransparency = 1,
                Text = sectionName or "Section",
                Font = Enum.Font.GothamBold,
                TextSize = 15,
                TextColor3 = THEME.Text,
                TextXAlignment = Enum.TextXAlignment.Left
            })
            
            -- Section underline
            local underline = create("Frame", {
                Parent = sectionFrame,
                Size = UDim2.new(1, 0, 0, 2),
                Position = UDim2.new(0, 0, 1, -2),
                BackgroundColor3 = THEME.Accent,
                BackgroundTransparency = 0.5,
                BorderSizePixel = 0
            })
            
            table.insert(tabData.elements, sectionFrame)
            return {
                Set = function(_, newName)
                    sectionLabel.Text = newName
                end
            }
        end
        
        -- Create Button
        function Tab:CreateButton(buttonData)
            buttonData = buttonData or {}
            local buttonName = buttonData.Name or "Button"
            local callback = buttonData.Callback or function() end
            local flag = buttonData.Flag
            
            local buttonFrame = create("TextButton", {
                Parent = tabContent,
                Size = UDim2.new(1, -20, 0, 40),
                BackgroundColor3 = THEME.Button,
                Text = "  " .. buttonName,
                Font = Enum.Font.Gotham,
                TextSize = 14,
                TextColor3 = THEME.Text,
                TextXAlignment = Enum.TextXAlignment.Left,
                BorderSizePixel = 0,
                AutoButtonColor = false
            })
            create("UICorner", {Parent = buttonFrame, CornerRadius = THEME.Corner})
            local buttonStroke = create("UIStroke", {
                Parent = buttonFrame,
                Color = THEME.Stroke,
                Thickness = 1.5,
                Transparency = 0.2
            })
            
            -- Hover effects
            buttonFrame.MouseEnter:Connect(function()
                tween(buttonFrame, 0.2, {BackgroundColor3 = THEME.Hover})
                tween(buttonStroke, 0.2, {Transparency = 0})
            end)
            
            buttonFrame.MouseLeave:Connect(function()
                tween(buttonFrame, 0.2, {BackgroundColor3 = THEME.Button})
                tween(buttonStroke, 0.2, {Transparency = 0.2})
            end)
            
            -- Click handler
            buttonFrame.MouseButton1Click:Connect(function()
                tween(buttonFrame, 0.1, {BackgroundColor3 = THEME.Active})
                
                local success, error = pcall(callback)
                if not success then
                    tween(buttonFrame, 0.2, {BackgroundColor3 = THEME.Error})
                    task.wait(0.3)
                    tween(buttonFrame, 0.2, {BackgroundColor3 = THEME.Button})
                    warn("GabGui Button Error (" .. buttonName .. "): " .. tostring(error))
                else
                    task.wait(0.1)
                    tween(buttonFrame, 0.2, {BackgroundColor3 = THEME.Button})
                end
                
                if flag then
                    WindowObject.Flags[flag] = true
                end
            end)
            
            table.insert(tabData.elements, buttonFrame)
            return {
                Set = function(_, newText)
                    buttonFrame.Text = "  " .. newText
                end
            }
        end
        
        -- Create Toggle
        function Tab:CreateToggle(toggleData)
            toggleData = toggleData or {}
            local toggleName = toggleData.Name or "Toggle"
            local currentValue = toggleData.CurrentValue or false
            local callback = toggleData.Callback or function() end
            local flag = toggleData.Flag
            
            local toggleFrame = create("Frame", {
                Parent = tabContent,
                Size = UDim2.new(1, -20, 0, 42),
                BackgroundColor3 = THEME.Button,
                BorderSizePixel = 0
            })
            create("UICorner", {Parent = toggleFrame, CornerRadius = THEME.Corner})
            local toggleStroke = create("UIStroke", {
                Parent = toggleFrame,
                Color = THEME.Stroke,
                Thickness = 1.5,
                Transparency = 0.2
            })
            
            -- Label
            local toggleLabel = create("TextLabel", {
                Parent = toggleFrame,
                Size = UDim2.new(0.7, 0, 1, 0),
                Position = UDim2.new(0, 12, 0, 0),
                BackgroundTransparency = 1,
                Text = toggleName,
                Font = Enum.Font.Gotham,
                TextSize = 14,
                TextColor3 = THEME.Text,
                TextXAlignment = Enum.TextXAlignment.Left,
                TextYAlignment = Enum.TextYAlignment.Center
            })
            
            -- Toggle Switch
            local switchFrame = create("Frame", {
                Parent = toggleFrame,
                Size = UDim2.new(0, 50, 0, 26),
                Position = UDim2.new(1, -60, 0.5, -13),
                BackgroundColor3 = currentValue and THEME.ToggleOn or THEME.ToggleOff,
                BorderSizePixel = 0
            })
            create("UICorner", {Parent = switchFrame, CornerRadius = UDim.new(1, 0)})
            local switchStroke = create("UIStroke", {
                Parent = switchFrame,
                Color = THEME.Stroke,
                Thickness = 1.5,
                Transparency = 0.3
            })
            
            local switchKnob = create("Frame", {
                Parent = switchFrame,
                Size = UDim2.new(0, 22, 0, 22),
                Position = currentValue and UDim2.new(1, -24, 0.5, -11) or UDim2.new(0, 2, 0.5, -11),
                BackgroundColor3 = Color3.fromRGB(255, 255, 255),
                BorderSizePixel = 0
            })
            create("UICorner", {Parent = switchKnob, CornerRadius = UDim.new(1, 0)})
            
            -- Toggle interaction
            local function setToggle(value)
                currentValue = value
                local targetPos = value and UDim2.new(1, -24, 0.5, -11) or UDim2.new(0, 2, 0.5, -11)
                local targetColor = value and THEME.ToggleOn or THEME.ToggleOff
                
                tween(switchKnob, 0.3, {Position = targetPos})
                tween(switchFrame, 0.3, {BackgroundColor3 = targetColor})
                
                local success, error = pcall(callback, value)
                if not success then
                    tween(toggleFrame, 0.2, {BackgroundColor3 = THEME.Error})
                    task.wait(0.3)
                    tween(toggleFrame, 0.2, {BackgroundColor3 = THEME.Button})
                    warn("GabGui Toggle Error (" .. toggleName .. "): " .. tostring(error))
                end
                
                if flag then
                    WindowObject.Flags[flag] = value
                end
            end
            
            switchFrame.InputBegan:Connect(function(input)
                if input.UserInputType == Enum.UserInputType.MouseButton1 then
                    setToggle(not currentValue)
                end
            end)
            
            -- Hover effects
            toggleFrame.MouseEnter:Connect(function()
                tween(toggleFrame, 0.2, {BackgroundColor3 = THEME.Hover})
            end)
            
            toggleFrame.MouseLeave:Connect(function()
                tween(toggleFrame, 0.2, {BackgroundColor3 = THEME.Button})
            end)
            
            table.insert(tabData.elements, toggleFrame)
            return {
                Set = function(_, value)
                    setToggle(value)
                end,
                Get = function() return currentValue end
            }
        end
        
        -- Create Slider
        function Tab:CreateSlider(sliderData)
            sliderData = sliderData or {}
            local sliderName = sliderData.Name or "Slider"
            local range = sliderData.Range or {0, 100}
            local increment = sliderData.Increment or 1
            local currentValue = sliderData.CurrentValue or range[1]
            local suffix = sliderData.Suffix or ""
            local callback = sliderData.Callback or function() end
            local flag = sliderData.Flag
            
            local sliderFrame = create("Frame", {
                Parent = tabContent,
                Size = UDim2.new(1, -20, 0, 50),
                BackgroundColor3 = THEME.Button,
                BorderSizePixel = 0
            })
            create("UICorner", {Parent = sliderFrame, CornerRadius = THEME.Corner})
            local sliderStroke = create("UIStroke", {
                Parent = sliderFrame,
                Color = THEME.Stroke,
                Thickness = 1.5,
                Transparency = 0.2
            })
            
            -- Label
            local sliderLabel = create("TextLabel", {
                Parent = sliderFrame,
                Size = UDim2.new(1, 0, 0, 20),
                Position = UDim2.new(0, 12, 0, 8),
                BackgroundTransparency = 1,
                Text = sliderName .. ": " .. tostring(currentValue) .. suffix,
                Font = Enum.Font.Gotham,
                TextSize = 14,
                TextColor3 = THEME.Text,
                TextXAlignment = Enum.TextXAlignment.Left
            })
            
            -- Slider Track
            local sliderTrack = create("Frame", {
                Parent = sliderFrame,
                Size = UDim2.new(1, -24, 0, 8),
                Position = UDim2.new(0, 12, 0, 32),
                BackgroundColor3 = THEME.SliderTrack,
                BorderSizePixel = 0
            })
            create("UICorner", {Parent = sliderTrack, CornerRadius = UDim.new(0, 4)})
            create("UIStroke", {Parent = sliderTrack, Color = THEME.StrokeSecondary, Thickness = 1, Transparency = 0.5})
            
            local sliderFill = create("Frame", {
                Parent = sliderTrack,
                Size = UDim2.new((currentValue - range[1]) / (range[2] - range[1]), 0, 1, 0),
                BackgroundColor3 = THEME.SliderFill,
                BorderSizePixel = 0
            })
            create("UICorner", {Parent = sliderFill, CornerRadius = UDim.new(0, 4)})
            local fillStroke = create("UIStroke", {
                Parent = sliderFill,
                Color = Color3.fromRGB(200, 0, 255),
                Thickness = 1,
                Transparency = 0.3
            })
            
            local dragging = false
            
            local function updateSlider(value)
                value = math.clamp(value, range[1], range[2])
                value = math.floor((value - range[1]) / increment + 0.5) * increment + range[1]
                local percent = (value - range[1]) / (range[2] - range[1])
                
                tween(sliderFill, 0.2, {Size = UDim2.new(percent, 0, 1, 0)})
                sliderLabel.Text = sliderName .. ": " .. tostring(value) .. suffix
                currentValue = value
                
                local success, error = pcall(callback, value)
                if not success then
                    tween(sliderFrame, 0.2, {BackgroundColor3 = THEME.Error})
                    task.wait(0.3)
                    tween(sliderFrame, 0.2, {BackgroundColor3 = THEME.Button})
                    warn("GabGui Slider Error (" .. sliderName .. "): " .. tostring(error))
                end
                
                if flag then
                    WindowObject.Flags[flag] = value
                end
            end
            
            -- Slider interaction
            sliderTrack.InputBegan:Connect(function(input)
                if input.UserInputType == Enum.UserInputType.MouseButton1 then
                    dragging = true
                    local relativeX = math.clamp((input.Position.X - sliderTrack.AbsolutePosition.X) / sliderTrack.AbsoluteSize.X, 0, 1)
                    local newValue = range[1] + relativeX * (range[2] - range[1])
                    updateSlider(newValue)
                    tween(fillStroke, 0.2, {Transparency = 0})
                end
            end)
            
            UserInputService.InputEnded:Connect(function(input)
                if input.UserInputType == Enum.UserInputType.MouseButton1 then
                    dragging = false
                    tween(fillStroke, 0.2, {Transparency = 0.3})
                end
            end)
            
            UserInputService.InputChanged:Connect(function(input)
                if dragging and input.UserInputType == Enum.UserInputType.MouseMovement then
                    local relativeX = math.clamp((input.Position.X - sliderTrack.AbsolutePosition.X) / sliderTrack.AbsoluteSize.X, 0, 1)
                    local newValue = range[1] + relativeX * (range[2] - range[1])
                    updateSlider(newValue)
                end
            end)
            
            -- Hover effects
            sliderFrame.MouseEnter:Connect(function()
                tween(sliderFrame, 0.2, {BackgroundColor3 = THEME.Hover})
            end)
            
            sliderFrame.MouseLeave:Connect(function()
                tween(sliderFrame, 0.2, {BackgroundColor3 = THEME.Button})
            end)
            
            table.insert(tabData.elements, sliderFrame)
            return {
                Set = function(_, value)
                    updateSlider(value)
                end,
                Get = function() return currentValue end
            }
        end
        
        -- Create Input
        function Tab:CreateInput(inputData)
            inputData = inputData or {}
            local inputName = inputData.Name or "Input"
            local currentValue = inputData.CurrentValue or ""
            local placeholder = inputData.PlaceholderText or "Enter text..."
            local callback = inputData.Callback or function() end
            local flag = inputData.Flag
            local removeText = inputData.RemoveTextAfterFocusLost or false
            
            local inputFrame = create("Frame", {
                Parent = tabContent,
                Size = UDim2.new(1, -20, 0, 42),
                BackgroundColor3 = THEME.Button,
                BorderSizePixel = 0
            })
            create("UICorner", {Parent = inputFrame, CornerRadius = THEME.Corner})
            local inputStroke = create("UIStroke", {
                Parent = inputFrame,
                Color = THEME.Stroke,
                Thickness = 1.5,
                Transparency = 0.2
            })
            
            -- Label
            local inputLabel = create("TextLabel", {
                Parent = inputFrame,
                Size = UDim2.new(0.4, 0, 1, 0),
                Position = UDim2.new(0, 12, 0, 0),
                BackgroundTransparency = 1,
                Text = inputName,
                Font = Enum.Font.Gotham,
                TextSize = 14,
                TextColor3 = THEME.Text,
                TextXAlignment = Enum.TextXAlignment.Left,
                TextYAlignment = Enum.TextYAlignment.Center
            })
            
            -- Input Box
            local inputBox = create("TextBox", {
                Parent = inputFrame,
                Size = UDim2.new(0.55, -8, 0.7, 0),
                Position = UDim2.new(0.42, 0, 0.15, 0),
                BackgroundTransparency = 1,
                Text = currentValue,
                PlaceholderText = placeholder,
                PlaceholderColor3 = THEME.Placeholder,
                TextColor3 = THEME.Text,
                Font = Enum.Font.GothamSemibold,
                TextSize = 14,
                TextXAlignment = Enum.TextXAlignment.Left,
                ClearTextOnFocus = false,
                BorderSizePixel = 0
            })
            
            -- Underline
            local underline = create("Frame", {
                Parent = inputBox,
                Size = UDim2.new(1, 0, 0, 2),
                Position = UDim2.new(0, 0, 1, 2),
                BackgroundColor3 = THEME.Stroke,
                BackgroundTransparency = 0.4,
                BorderSizePixel = 0,
                AnchorPoint = Vector2.new(0, 1)
            })
            
            -- Focus effects
            inputBox.Focused:Connect(function()
                tween(underline, 0.2, {BackgroundTransparency = 0, BackgroundColor3 = Color3.fromRGB(200, 0, 255)})
                tween(inputStroke, 0.2, {Transparency = 0})
            end)
            
            inputBox.FocusLost:Connect(function(enterPressed)
                tween(underline, 0.2, {BackgroundTransparency = 0.4, BackgroundColor3 = THEME.Stroke})
                tween(inputStroke, 0.2, {Transparency = 0.2})
                
                local text = inputBox.Text
                if removeText then
                    inputBox.Text = ""
                end
                
                local success, error = pcall(callback, text)
                if not success then
                    tween(inputFrame, 0.2, {BackgroundColor3 = THEME.Error})
                    task.wait(0.3)
                    tween(inputFrame, 0.2, {BackgroundColor3 = THEME.Button})
                    warn("GabGui Input Error (" .. inputName .. "): " .. tostring(error))
                end
                
                if flag then
                    WindowObject.Flags[flag] = text
                end
            end)
            
            -- Hover effects
            inputFrame.MouseEnter:Connect(function()
                tween(inputFrame, 0.2, {BackgroundColor3 = THEME.Hover})
            end)
            
            inputFrame.MouseLeave:Connect(function()
                tween(inputFrame, 0.2, {BackgroundColor3 = THEME.Button})
            end)
            
            table.insert(tabData.elements, inputFrame)
            return {
                Set = function(_, text)
                    inputBox.Text = text
                    pcall(callback, text)
                end,
                Get = function() return inputBox.Text end
            }
        end
        
        -- Create Dropdown (Simplified)
        function Tab:CreateDropdown(dropdownData)
            dropdownData = dropdownData or {}
            local dropdownName = dropdownData.Name or "Dropdown"
            local options = dropdownData.Options or {"Option 1", "Option 2", "Option 3"}
            local currentOption = dropdownData.CurrentOption or options[1]
            local callback = dropdownData.Callback or function() end
            local flag = dropdownData.Flag
            local multiple = dropdownData.MultipleOptions or false
            
            local dropdownFrame = create("Frame", {
                Parent = tabContent,
                Size = UDim2.new(1, -20, 0, 42),
                BackgroundColor3 = THEME.Button,
                BorderSizePixel = 0
            })
            create("UICorner", {Parent = dropdownFrame, CornerRadius = THEME.Corner})
            local dropdownStroke = create("UIStroke", {
                Parent = dropdownFrame,
                Color = THEME.Stroke,
                Thickness = 1.5,
                Transparency = 0.2
            })
            
            -- Label
            local dropdownLabel = create("TextLabel", {
                Parent = dropdownFrame,
                Size = UDim2.new(0.6, 0, 1, 0),
                Position = UDim2.new(0, 12, 0, 0),
                BackgroundTransparency = 1,
                Text = dropdownName,
                Font = Enum.Font.Gotham,
                TextSize = 14,
                TextColor3 = THEME.Text,
                TextXAlignment = Enum.TextXAlignment.Left,
                TextYAlignment = Enum.TextYAlignment.Center
            })
            
            -- Dropdown Button
            local dropdownButton = create("TextButton", {
                Parent = dropdownFrame,
                Size = UDim2.new(0.35, -8, 0.8, 0),
                Position = UDim2.new(0.63, 0, 0.1, 0),
                BackgroundColor3 = THEME.Secondary,
                Text = tostring(currentOption) .. " ▼",
                Font = Enum.Font.GothamSemibold,
                TextSize = 13,
                TextColor3 = THEME.Text,
                BorderSizePixel = 0,
                AutoButtonColor = false,
                TextXAlignment = Enum.TextXAlignment.Center
            })
            create("UICorner", {Parent = dropdownButton, CornerRadius = UDim.new(0, 6)})
            local buttonStroke = create("UIStroke", {
                Parent = dropdownButton,
                Color = THEME.Stroke,
                Thickness = 1,
                Transparency = 0.4
            })
            
            -- Dropdown List (simplified - shows first 5 options)
            local dropdownList = create("Frame", {
                Parent = tabContent,
                Size = UDim2.new(1, -20, 0, 0),
                Position = UDim2.new(0, 0, 0, 42),
                BackgroundColor3 = THEME.Element,
                BorderSizePixel = 0,
                Visible = false
            })
            create("UICorner", {Parent = dropdownList, CornerRadius = THEME.Corner})
            local listStroke = create("UIStroke", {
                Parent = dropdownList,
                Color = THEME.StrokeSecondary,
                Thickness = 1.5,
                Transparency = 0.3
            })
            
            local listLayout = create("UIListLayout", {
                Parent = dropdownList,
                Padding = UDim.new(0, 2),
                FillDirection = Enum.FillDirection.Vertical
            })
            
            local dropdownOpen = false
            
            -- Create option buttons
            for i, option in ipairs(options) do
                if i > 5 then break end -- Limit to 5 visible options
                
                local optionButton = create("TextButton", {
                    Parent = dropdownList,
                    Size = UDim2.new(1, -12, 0, 32),
                    BackgroundColor3 = option == currentOption and Color3.fromRGB(60, 0, 100) or THEME.Button,
                    Text = option,
                    Font = Enum.Font.Gotham,
                    TextSize = 14,
                    TextColor3 = THEME.Text,
                    BorderSizePixel = 0,
                    AutoButtonColor = false
                })
                create("UICorner", {Parent = optionButton, CornerRadius = UDim.new(0, 6)})
                local optionStroke = create("UIStroke", {
                    Parent = optionButton,
                    Color = THEME.Stroke,
                    Thickness = 1,
                    Transparency = option == currentOption and 0.3 or 1
                })
                
                optionButton.MouseButton1Click:Connect(function()
                    currentOption = option
                    dropdownButton.Text = option .. " ▼"
                    
                    -- Update all option buttons
                    for _, btn in ipairs(dropdownList:GetChildren()) do
                        if btn:IsA("TextButton") then
                            local isSelected = btn.Text == option
                            tween(btn, 0.2, {BackgroundColor3 = isSelected and Color3.fromRGB(60, 0, 100) or THEME.Button})
                            btn.UIStroke.Transparency = isSelected and 0.3 or 1
                        end
                    end
                    
                    -- Close dropdown
                    dropdownOpen = false
                    dropdownList.Visible = false
                    tween(dropdownFrame, 0.2, {BackgroundColor3 = THEME.Button})
                    tween(dropdownStroke, 0.2, {Transparency = 0.2})
                    tween(dropdownButton, 0.2, {BackgroundColor3 = THEME.Secondary})
                    tween(buttonStroke, 0.2, {Transparency = 0.4})
                    
                    pcall(callback, option)
                    if flag then
                        WindowObject.Flags[flag] = option
                    end
                end)
                
                optionButton.MouseEnter:Connect(function()
                    if option ~= currentOption then
                        tween(optionButton, 0.2, {BackgroundColor3 = THEME.Hover})
                    end
                end)
                
                optionButton.MouseLeave:Connect(function()
                    if option ~= currentOption then
                        tween(optionButton, 0.2, {BackgroundColor3 = THEME.Button})
                    end
                end)
            end
            
            dropdownList.Size = UDim2.new(1, -20, 0, math.min(#options, 5) * 34)
            
            -- Toggle dropdown
            dropdownButton.MouseButton1Click:Connect(function()
                dropdownOpen = not dropdownOpen
                
                if dropdownOpen then
                    -- Open
                    dropdownList.Visible = true
                    tween(dropdownFrame, 0.2, {BackgroundColor3 = THEME.Hover})
                    tween(dropdownStroke, 0.2, {Transparency = 0})
                    tween(dropdownButton, 0.2, {BackgroundColor3 = Color3.fromRGB(60, 0, 100)})
                    tween(buttonStroke, 0.2, {Transparency = 0})
                else
                    -- Close
                    dropdownList.Visible = false
                    tween(dropdownFrame, 0.2, {BackgroundColor3 = THEME.Button})
                    tween(dropdownStroke, 0.2, {Transparency = 0.2})
                    tween(dropdownButton, 0.2, {BackgroundColor3 = THEME.Secondary})
                    tween(buttonStroke, 0.2, {Transparency = 0.4})
                end
            end)
            
            -- Hover effects
            dropdownFrame.MouseEnter:Connect(function()
                if not dropdownOpen then
                    tween(dropdownFrame, 0.2, {BackgroundColor3 = THEME.Hover})
                end
            end)
            
            dropdownFrame.MouseLeave:Connect(function()
                if not dropdownOpen then
                    tween(dropdownFrame, 0.2, {BackgroundColor3 = THEME.Button})
                end
            end)
            
            table.insert(tabData.elements, dropdownFrame)
            return {
                Set = function(_, value)
                    currentOption = value
                    dropdownButton.Text = tostring(value) .. " ▼"
                    pcall(callback, value)
                end,
                Get = function() return currentOption end
            }
        end
        
        -- Create Keybind
        function Tab:CreateKeybind(keybindData)
            keybindData = keybindData or {}
            local keybindName = keybindData.Name or "Keybind"
            local currentKeybind = keybindData.CurrentKeybind or "NONE"
            local holdToInteract = keybindData.HoldToInteract or false
            local callback = keybindData.Callback or function() end
            local flag = keybindData.Flag
            local callOnChange = keybindData.CallOnChange or false
            
            local keybindFrame = create("Frame", {
                Parent = tabContent,
                Size = UDim2.new(1, -20, 0, 42),
                BackgroundColor3 = THEME.Button,
                BorderSizePixel = 0
            })
            create("UICorner", {Parent = keybindFrame, CornerRadius = THEME.Corner})
            local keybindStroke = create("UIStroke", {
                Parent = keybindFrame,
                Color = THEME.Stroke,
                Thickness = 1.5,
                Transparency = 0.2
            })
            
            -- Label
            local keybindLabel = create("TextLabel", {
                Parent = keybindFrame,
                Size = UDim2.new(0.65, 0, 1, 0),
                Position = UDim2.new(0, 12, 0, 0),
                BackgroundTransparency = 1,
                Text = keybindName,
                Font = Enum.Font.Gotham,
                TextSize = 14,
                TextColor3 = THEME.Text,
                TextXAlignment = Enum.TextXAlignment.Left,
                TextYAlignment = Enum.TextYAlignment.Center
            })
            
            -- Keybind Button
            local keybindButton = create("TextButton", {
                Parent = keybindFrame,
                Size = UDim2.new(0.3, -8, 0.7, 0),
                Position = UDim2.new(0.68, 0, 0.15, 0),
                BackgroundColor3 = THEME.Secondary,
                Text = currentKeybind,
                Font = Enum.Font.GothamBold,
                TextSize = 13,
                TextColor3 = THEME.Text,
                BorderSizePixel = 0,
                AutoButtonColor = false,
                TextXAlignment = Enum.TextXAlignment.Center
            })
            create("UICorner", {Parent = keybindButton, CornerRadius = UDim.new(0, 6)})
            local buttonStroke = create("UIStroke", {
                Parent = keybindButton,
                Color = THEME.Stroke,
                Thickness = 1,
                Transparency = 0.4
            })
            
            local listening = false
            
            -- Start listening
            keybindButton.MouseButton1Click:Connect(function()
                listening = true
                keybindButton.Text = "..."
                tween(buttonStroke, 0.2, {Transparency = 0})
                tween(keybindButton, 0.2, {BackgroundColor3 = Color3.fromRGB(60, 0, 100)})
            end)
            
            -- Key detection
            UserInputService.InputBegan:Connect(function(input, gameProcessed)
                if listening and not gameProcessed and input.KeyCode ~= Enum.KeyCode.Unknown then
                    local newKey = input.KeyCode.Name
                    currentKeybind = newKey
                    keybindButton.Text = newKey
                    listening = false
                    
                    tween(buttonStroke, 0.2, {Transparency = 0.4})
                    tween(keybindButton, 0.2, {BackgroundColor3 = THEME.Secondary})
                    tween(keybindButton, 0.2, {TextColor3 = Color3.fromRGB(200, 150, 255)})
                    task.wait(0.2)
                    tween(keybindButton, 0.2, {TextColor3 = THEME.Text})
                    
                    if callOnChange then
                        pcall(callback, newKey)
                    end
                    
                    if flag then
                        WindowObject.Flags[flag] = newKey
                    end
                elseif not gameProcessed and input.KeyCode.Name == currentKeybind and currentKeybind ~= "NONE" then
                    if holdToInteract then
                        local held = true
                        local connection = input.Changed:Connect(function(property)
                            if property == "UserInputState" and input.UserInputState == Enum.UserInputState.End then
                                held = false
                                connection:Disconnect()
                                pcall(callback, false)
                            end
                        end)
                        
                        spawn(function()
                            while held do
                                pcall(callback, true)
                                RunService.Heartbeat:Wait()
                            end
                        end)
                    else
                        pcall(callback, true)
                    end
                end
            end)
            
            -- Hover effects
            keybindFrame.MouseEnter:Connect(function()
                tween(keybindFrame, 0.2, {BackgroundColor3 = THEME.Hover})
            end)
            
            keybindFrame.MouseLeave:Connect(function()
                tween(keybindFrame, 0.2, {BackgroundColor3 = THEME.Button})
            end)
            
            table.insert(tabData.elements, keybindFrame)
            return {
                Set = function(_, newKey)
                    currentKeybind = newKey
                    keybindButton.Text = newKey
                    if callOnChange then
                        pcall(callback, newKey)
                    end
                end,
                Get = function() return currentKeybind end
            }
        end
        
        -- Create Label
        function Tab:CreateLabel(text, icon, color)
            local labelColor = color or THEME.Text
            local labelFrame = create("Frame", {
                Parent = tabContent,
                Size = UDim2.new(1, -20, 0, 32),
                BackgroundColor3 = THEME.Secondary,
                BackgroundTransparency = 0.9,
                BorderSizePixel = 0
            })
            create("UICorner", {Parent = labelFrame, CornerRadius = THEME.Corner})
            local labelStroke = create("UIStroke", {
                Parent = labelFrame,
                Color = THEME.StrokeSecondary,
                Thickness = 1,
                Transparency = 0.7
            })
            
            local labelText = create("TextLabel", {
                Parent = labelFrame,
                Size = UDim2.new(1, -12, 1, 0),
                Position = UDim2.new(0, 12, 0, 0),
                BackgroundTransparency = 1,
                Text = text or "",
                Font = Enum.Font.Gotham,
                TextSize = 14,
                TextColor3 = labelColor,
                TextXAlignment = Enum.TextXAlignment.Left,
                TextYAlignment = Enum.TextYAlignment.Center,
                TextWrapped = true
            })
            
            if icon and icon ~= 0 then
                local labelIcon = create("ImageLabel", {
                    Parent = labelFrame,
                    Size = UDim2.new(0, 20, 0, 20),
                    Position = UDim2.new(0, 8, 0.5, -10),
                    BackgroundTransparency = 1,
                    Image = "rbxassetid://" .. tostring(icon),
                    ImageColor3 = labelColor
                })
                create("UICorner", {Parent = labelIcon, CornerRadius = UDim.new(0, 4)})
                labelText.Position = UDim2.new(0, 36, 0, 0)
                labelText.Size = UDim2.new(1, -48, 1, 0)
            end
            
            table.insert(tabData.elements, labelFrame)
            return {
                Set = function(_, newText, newIcon, newColor)
                    labelText.Text = newText or ""
                    if newColor then
                        labelText.TextColor3 = newColor
                        if labelFrame:FindFirstChild("ImageLabel") then
                            labelFrame.ImageLabel.ImageColor3 = newColor
                        end
                    end
                end
            }
        end
        
        -- Create Paragraph
        function Tab:CreateParagraph(paragraphData)
            paragraphData = paragraphData or {}
            local title = paragraphData.Title or "Paragraph"
            local content = paragraphData.Content or "Content goes here..."
            
            local paragraphFrame = create("Frame", {
                Parent = tabContent,
                BackgroundColor3 = THEME.Element,
                Size = UDim2.new(1, -20, 0, 80),
                BorderSizePixel = 0
            })
            create("UICorner", {Parent = paragraphFrame, CornerRadius = THEME.Corner})
            create("UIStroke", {Parent = paragraphFrame, Color = THEME.Stroke, Thickness = 1.5, Transparency = 0.1})
            
            local paragraphTitle = create("TextLabel", {
                Parent = paragraphFrame,
                Size = UDim2.new(1, -16, 0, 20),
                Position = UDim2.new(0, 8, 0, 8),
                BackgroundTransparency = 1,
                Text = title,
                Font = Enum.Font.GothamBold,
                TextSize = 15,
                TextColor3 = THEME.Text,
                TextXAlignment = Enum.TextXAlignment.Left
            })
            
            local paragraphContent = create("TextLabel", {
                Parent = paragraphFrame,
                Size = UDim2.new(1, -16, 0, 50),
                Position = UDim2.new(0, 8, 0, 32),
                BackgroundTransparency = 1,
                Text = content,
                Font = Enum.Font.Gotham,
                TextSize = 14,
                TextColor3 = THEME.Text,
                TextWrapped = true,
                TextXAlignment = Enum.TextXAlignment.Left
            })
            
            local function resizeParagraph()
                local textBounds = game:GetService("TextService"):GetTextSize(
                    paragraphContent.Text, 
                    paragraphContent.TextSize, 
                    paragraphContent.Font, 
                    Vector2.new(paragraphFrame.AbsoluteSize.X - 16, math.huge)
                )
                paragraphContent.Size = UDim2.new(1, -16, 0, textBounds.Y)
                paragraphFrame.Size = UDim2.new(1, -20, 0, textBounds.Y + 40)
            end
            resizeParagraph()
            
            paragraphContent:GetPropertyChangedSignal("Text"):Connect(resizeParagraph)
            
            table.insert(tabData.elements, paragraphFrame)
            return {
                Set = function(_, newData)
                    if newData.Title then
                        paragraphTitle.Text = newData.Title
                    end
                    if newData.Content then
                        paragraphContent.Text = newData.Content
                        resizeParagraph()
                    end
                end
            }
        end
        
        -- Create Divider
        function Tab:CreateDivider()
            local dividerFrame = create("Frame", {
                Parent = tabContent,
                Size = UDim2.new(1, -20, 0, 12),
                BackgroundTransparency = 1
            })
            
            local dividerLine = create("Frame", {
                Parent = dividerFrame,
                Size = UDim2.new(1, 0, 0, 1),
                Position = UDim2.new(0, 0, 0.5, 0),
                BackgroundColor3 = THEME.StrokeSecondary,
                BackgroundTransparency = 0.7,
                BorderSizePixel = 0,
                AnchorPoint = Vector2.new(0, 0.5)
            })
            
            table.insert(tabData.elements, dividerFrame)
            return {
                Set = function(_, visible)
                    dividerFrame.Visible = visible or true
                end
            }
        end
        
        -- Tab Notification
        function Tab:Notify(data)
            GabGuiLibrary:Notify(data)
        end
        
        return Tab
    end
    
    -- Window Methods
    function WindowObject:Notify(data)
        GabGuiLibrary:Notify(data)
    end
    
    function WindowObject:LoadConfiguration(configData)
        if type(configData) == "table" then
            for flag, value in pairs(configData) do
                if self.Flags[flag] and self.Flags[flag].Set then
                    self.Flags[flag]:Set(value)
                end
            end
        end
    end
    
    function WindowObject:SaveConfiguration()
        local config = {}
        for flag, element in pairs(self.Flags) do
            if element.Get then
                config[flag] = element:Get()
            end
        end
        return config
    end
    
    function WindowObject:Destroy()
        ScreenGui:Destroy()
    end
    
    -- Window Animation
    Window.Size = UDim2.new(0, 0, 0, 0)
    Window.Visible = true
    
    task.wait(0.1)
    tween(Window, 0.5, {
        Size = size,
        Position = position
    }, Enum.EasingStyle.Back, Enum.EasingDirection.Out)
    
    -- Global hotkey
    local hotkey = self:getSetting("General", "GabGuiOpen") or "K"
    UserInputService.InputBegan:Connect(function(input, gameProcessed)
        if not gameProcessed and input.KeyCode.Name == hotkey then
            Window.Visible = not Window.Visible
        end
    end)
    
    -- Initial notification
    task.wait(0.5)
    self:Notify({
        Title = "GabGui Loaded",
        Content = "Welcome to the modern Rayfield-inspired interface!",
        Duration = 3,
        Image = 4483362458
    })
    
    return WindowObject
end

-- Global functions
function GabGuiLibrary:LoadConfiguration(filename)
    -- Simple file loading (implement based on your executor)
    if isfile and readfile then
        local success, data = pcall(function()
            return readfile(filename .. ".json")
        end)
        if success then
            local config = HttpService:JSONDecode(data)
            return config
        end
    end
    return {}
end

function GabGuiLibrary:SaveConfiguration(filename, config)
    if writefile then
        writefile(filename .. ".json", HttpService:JSONEncode(config))
    end
end

-- Export library
_G.GabGui = GabGuiLibrary
return GabGuiLibrary

